<app-base-card [card]="card" [isEditing]="isEditing" [showFullscreenButton]="true" (fullscreenChange)="fullscreenChange.emit($event)">
  <div header class="flex justify-between items-center">
    <div class="flex items-center gap-2">
      <span>&nbsp;</span>
    </div>
  </div>
  <div body class="h-full flex flex-col">
    <div class="flex-1 min-h-0 flex flex-col relative">
      <!-- Loader overlay -->
      <div *ngIf="chartState.loading" 
           class="absolute inset-0 z-20 bg-gray-900/90 flex items-center justify-center">
        <div class="flex items-center">
          <div class="animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500"></div>
        </div>
      </div>

      <!-- Error message -->
      <div *ngIf="chartState.error" 
           class="absolute inset-0 z-20 bg-gray-900/90 flex items-center justify-center">
        <div class="text-red-500">{{ chartState.error }}</div>
      </div>

      <!-- Chart container -->
      <div class="flex-1">
        <div #chartContainer class="w-full h-full"></div>
      </div>
    </div>
  </div>
  <div footer>
    <!-- Parameters footer -->
    <app-chart-parameters-footer
      [datasource]="card.configuration?.datasource"
      [parameters]="requestParameters"
      [storedProcedureParameters]="card.configuration?.chartParameters?.parameters || []"
      [lastUpdate]="chartState.lastUpdate"
      [autoRefreshInterval]="card.configuration?.chartParameters?.autoRefreshInterval"
      [cardId]="card.id"
      (parametersChange)="onRequestParametersChange($event)"
      (storedProcedureParametersChange)="onStoredProcedureParametersChange($event)"
      (refresh)="loadData()">
    </app-chart-parameters-footer>
  </div>
</app-base-card>
