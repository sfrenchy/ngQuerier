<div class="row-wrapper">
  <div class="row-container p-4 bg-gray-800 rounded-lg shadow relative group"
       cdkDrag
       [cdkDragDisabled]="isResizing">
    <!-- Row header -->
    <div class="flex justify-between items-center mb-4">
      <div class="flex items-center gap-2">
        <button class="text-gray-400 hover:text-white"
                (click)="onEdit.emit()">
          <i class="fas fa-cog"></i>
        </button>
        <button class="text-gray-400 hover:text-white"
                (click)="onDelete.emit()">
          <i class="fas fa-trash"></i>
        </button>
      </div>
      <div class="text-gray-400">
        {{ row.height }}px
      </div>
    </div>

    <!-- Cards container -->
    <div class="cards-container"
         cdkDropList
         [id]="getDropListId()"
         [cdkDropListData]="row.cards"
         [cdkDropListConnectedTo]="['card-palette']"
         (cdkDropListDropped)="handleCardDrop($event)">
      <div class="cards-wrapper"
           [style.min-height.px]="row.height">
        <!-- Cards -->
        <ng-container *ngFor="let card of row.cards">
          <div class="card"
               [style.flex]="'0 0 ' + (card.gridWidth / 12 * 100) + '%'"
               [style.max-width.%]="(card.gridWidth / 12 * 100)"
               cdkDrag
               [cdkDragData]="card">
            <app-placeholder-card *ngIf="card.type === 'placeholder'"
                                [card]="card"
                                [isEditing]="true"
                                [maxRowHeight]="row.height"
                                (onEdit)="handleCardEdit(card)"
                                (onDelete)="onCardDelete.emit(card)">
              <div dragHandle class="cursor-move text-gray-400">
                <i class="fas fa-grip-vertical"></i>
              </div>
            </app-placeholder-card>
          </div>
        </ng-container>

        <!-- Empty state / Drop zone -->
        <div *ngIf="row.cards.length === 0"
             class="empty-drop-zone border-2 border-dashed border-gray-600 rounded">
          <span class="text-gray-400">{{ 'MENU.PAGES.LAYOUT.DROP_CARD_HERE' | translate }}</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Row resizer -->
  <app-row-resizer 
    [currentHeight]="row.height"
    (heightChange)="onHeightChange.emit({ rowId: row.id, height: $event })"
    (resizing)="isResizing = $event">
  </app-row-resizer>

  <!-- Card configuration dialog -->
  <app-placeholder-card-config *ngIf="editingCard"
                             [card]="editingCard"
                             (save)="handleCardConfigSave($event)"
                             (cancel)="handleCardConfigCancel()">
  </app-placeholder-card-config>
</div> 