<button 
  type="button"
  class="inline-flex items-center justify-center w-9 h-9 rounded border border-gray-600 bg-gray-800 text-gray-100 hover:bg-gray-700"
  [class.opacity-50]="disabled"
  (click)="toggleDropdown()"
>
  <fa-icon 
    *ngIf="value" 
    [icon]="['fas', value]"
    [fixedWidth]="true"
  ></fa-icon>
  <span *ngIf="!value" class="text-sm">?</span>
</button>

<div *ngIf="isOpen" class="fixed inset-0 bg-black bg-opacity-50" (click)="isOpen = false">
  <div class="fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-gray-800 rounded-lg shadow-xl p-4" (click)="$event.stopPropagation()">
    <div class="flex justify-between items-center mb-4">
      <div class="flex-1 mr-8">
        <input
          type="text"
          [(ngModel)]="searchTerm"
          (ngModelChange)="onSearch($event)"
          [placeholder]="'ICON_PICKER.SEARCH_PLACEHOLDER' | translate"
          class="w-full px-3 py-2 rounded border border-gray-600 bg-gray-700 text-gray-100 placeholder-gray-400 focus:outline-none focus:border-blue-500"
          (click)="$event.stopPropagation()"
        >
      </div>
      <button
        type="button"
        class="text-gray-400 hover:text-gray-200"
        (click)="isOpen = false"
        [title]="'ICON_PICKER.CLOSE' | translate"
      >
        <fa-icon [icon]="['fas', 'times']"></fa-icon>
      </button>
    </div>

    <div class="grid grid-cols-8 gap-2 max-h-96 overflow-y-auto">
      <button
        *ngFor="let key of getIconKeys()"
        type="button"
        class="inline-flex items-center justify-center w-9 h-9 rounded border border-gray-600 bg-gray-800 text-gray-100 hover:bg-gray-700 relative"
        [class.!bg-blue-700]="value === key"
        [class.!border-blue-400]="value === key"
        [class.!text-white]="value === key"
        [class.ring-2]="value === key"
        [class.ring-blue-400]="value === key"
        (click)="selectIcon(key)"
        [title]="key"
      >
        <fa-icon [icon]="['fas', key]" [fixedWidth]="true"></fa-icon>
      </button>
    </div>
    
    <div class="flex items-center justify-between mt-4 border-t border-gray-600 pt-4">
      <button
        type="button"
        class="px-3 py-1 rounded border border-gray-600 bg-gray-800 text-gray-100 hover:bg-gray-700 disabled:opacity-50"
        [disabled]="currentPage === 1"
        (click)="previousPage(); $event.stopPropagation()"
      >
        {{ 'ICON_PICKER.PREVIOUS' | translate }}
      </button>
      
      <span class="text-gray-300">
        {{ 'ICON_PICKER.PAGE' | translate }} {{ currentPage }} / {{ getTotalPages() }}
      </span>
      
      <button
        type="button"
        class="px-3 py-1 rounded border border-gray-600 bg-gray-800 text-gray-100 hover:bg-gray-700 disabled:opacity-50"
        [disabled]="currentPage === getTotalPages()"
        (click)="nextPage(); $event.stopPropagation()"
      >
        {{ 'ICON_PICKER.NEXT' | translate }}
      </button>
    </div>
  </div>
</div>
